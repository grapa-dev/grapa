/* Test Unicode Grapheme Clusters */
/* This test verifies that Unicode grapheme clusters (\X) work correctly */

"=== UNICODE GRAPHEME CLUSTERS TEST ===\n".echo();
"Testing Unicode grapheme cluster support\n".echo();

/* Test 1: Basic Grapheme Clusters */
"Test 1: Basic Grapheme Clusters\n".echo();
input = "Hello world";
result = input.grep("\\X", "oj");
if (result.type() != $ERR && result.len() > 0) {
    "PASS - Basic grapheme clusters work\n".echo();
} else {
    "FAIL - Basic grapheme clusters not working\n".echo();
}
"---\n".echo();

/* Test 2: Emoji Grapheme Clusters */
"Test 2: Emoji Grapheme Clusters\n".echo();
input = "Hello 👋 world 🌍";
result = input.grep("\\X", "oj");
if (result.type() != $ERR && result.len() > 0) {
    "PASS - Emoji grapheme clusters work\n".echo();
} else {
    "FAIL - Emoji grapheme clusters not working\n".echo();
}
"---\n".echo();

/* Test 3: Emoji Sequences (Family) */
"Test 3: Emoji Sequences (Family)\n".echo();
input = "Family: 👨‍👩‍👧‍👦";
result = input.grep("\\X", "oj");
if (result.type() != $ERR && result.len() > 0) {
    "PASS - Emoji sequence grapheme clusters work\n".echo();
} else {
    "FAIL - Emoji sequence grapheme clusters not working\n".echo();
}
"---\n".echo();

/* Test 4: Combining Characters */
"Test 4: Combining Characters\n".echo();
input = "café mañana";
result = input.grep("\\X", "oj");
if (result.type() != $ERR && result.len() > 0) {
    "PASS - Combining character grapheme clusters work\n".echo();
} else {
    "FAIL - Combining character grapheme clusters not working\n".echo();
}
"---\n".echo();

/* Test 5: Zero Width Joiner Sequences */
"Test 5: Zero Width Joiner Sequences\n".echo();
input = "Flag: 🇺🇸";
result = input.grep("\\X", "oj");
if (result.type() != $ERR && result.len() > 0) {
    "PASS - ZWJ sequence grapheme clusters work\n".echo();
} else {
    "FAIL - ZWJ sequence grapheme clusters not working\n".echo();
}
"---\n".echo();

/* Test 6: Complex Unicode Sequences */
"Test 6: Complex Unicode Sequences\n".echo();
input = "👨‍💻👩‍🏫👶‍👧";
result = input.grep("\\X", "oj");
if (result.type() != $ERR && result.len() > 0) {
    "PASS - Complex Unicode sequence grapheme clusters work\n".echo();
} else {
    "FAIL - Complex Unicode sequence grapheme clusters not working\n".echo();
}
"---\n".echo();

/* Test 7: Mixed Content */
"Test 7: Mixed Content\n".echo();
input = "Hello 👋 world 🌍 with café and mañana";
result = input.grep("\\X", "oj");
if (result.type() != $ERR && result.len() > 0) {
    "PASS - Mixed content grapheme clusters work\n".echo();
} else {
    "FAIL - Mixed content grapheme clusters not working\n".echo();
}
"---\n".echo();

/* Test 8: Grapheme Cluster Boundaries */
"Test 8: Grapheme Cluster Boundaries\n".echo();
input = "👨‍👩‍👧‍👦";
result = input.grep("\\X+", "oj");
if (result.type() != $ERR && result.len() > 0) {
    "PASS - Grapheme cluster boundaries work\n".echo();
} else {
    "FAIL - Grapheme cluster boundaries not working\n".echo();
}
"---\n".echo();

/* Test 9: Unicode Scripts with Grapheme Clusters */
"Test 9: Unicode Scripts with Grapheme Clusters\n".echo();
input = "Hello 世界 👋 世界";
result = input.grep("\\X", "oj");
if (result.type() != $ERR && result.len() > 0) {
    "PASS - Unicode scripts with grapheme clusters work\n".echo();
} else {
    "FAIL - Unicode scripts with grapheme clusters not working\n".echo();
}
"---\n".echo();

/* Test 10: Edge Cases */
"Test 10: Edge Cases\n".echo();
input = "a\u0301b\u0302c\u0303"; /* Combining marks */
result = input.grep("\\X", "oj");
if (result.type() != $ERR && result.len() > 0) {
    "PASS - Edge case grapheme clusters work\n".echo();
} else {
    "FAIL - Edge case grapheme clusters not working\n".echo();
}
"---\n".echo();

"=== UNICODE GRAPHEME CLUSTERS TEST COMPLETED ===\n".echo();
"Unicode grapheme cluster support tested successfully!\n".echo(); 