/* Test to analyze character mapping issues */

"=== CHARACTER MAPPING ANALYSIS ===\n".echo();

/* Test 1: Simple case-insensitive mapping */
"Test 1: Simple case-insensitive mapping\n".echo();
result1 = "ÉÑÜ".grep(".", "oi");
("Input: ÉÑÜ\n").echo();
("Pattern: ., Options: oi\n").echo();
("Result: " + result1.str() + "\n").echo();
("Expected: [\"É\",\"Ñ\",\"Ü\"]\n").echo();
("Issue: Characters are grouped incorrectly\n").echo();
"---\n".echo();

/* Test 2: Mixed case mapping */
"Test 2: Mixed case mapping\n".echo();
result2 = "ÉñÜ".grep(".", "oi");
("Input: ÉñÜ\n").echo();
("Pattern: ., Options: oi\n").echo();
("Result: " + result2.str() + "\n").echo();
("Expected: [\"É\",\"ñ\",\"Ü\"]\n").echo();
("Issue: Characters are grouped incorrectly\n").echo();
"---\n".echo();

/* Test 3: Multiline with null values */
"Test 3: Multiline with null values\n".echo();
result3 = "ÉÑÜ\nABC\nDEF".grep(".", "oi");
("Input: ÉÑÜ\\nABC\\nDEF\n").echo();
("Pattern: ., Options: oi\n").echo();
("Result: " + result3.str() + "\n").echo();
("Issue: Contains null values instead of empty strings\n").echo();
"---\n".echo();

/* Test 4: Compare with non-case-insensitive */
"Test 4: Compare with non-case-insensitive\n".echo();
result4a = "ÉÑÜ".grep(".", "o");
result4b = "ÉÑÜ".grep(".", "oi");
("Input: ÉÑÜ\n").echo();
("Pattern: ., Options: o (case-sensitive): " + result4a.str() + "\n").echo();
("Pattern: ., Options: oi (case-insensitive): " + result4b.str() + "\n").echo();
("Issue: Case-insensitive changes character boundaries\n").echo();
"---\n".echo();

/* Test 5: Test with specific Unicode characters */
"Test 5: Test with specific Unicode characters\n".echo();
result5 = "éñü".grep("é", "oi");
("Input: éñü\n").echo();
("Pattern: é, Options: oi\n").echo();
("Result: " + result5.str() + "\n").echo();
("Expected: [\"é\"]\n").echo();
"---\n".echo();

"=== ANALYSIS COMPLETE ===\n".echo(); 